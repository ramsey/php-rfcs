====== PHP RFC: Make allow_url_include actually disallow URL form includes ======
  * Version: 1.0
  * Date: 2015-02-27
  * Author: Yasuo Ohgaki <yohgaki@ohgaki.net>
  * Status: Under Discussion
  * First Published at: http://wiki.php.net/rfc/allow_url_include

===== Introduction =====

**allow_url_include** is INI_SYSTEM, therefore include/require simply ignore the setting for certain stream wrappers always.
**allow_url_include** does not actually disallow URL form includes. It allows "<nowiki>phar://</nowiki>" regardless of **allow_url_include** setting and helps attackers obfuscate  attack scripts. e.g. include("<nowiki>phar://evil_phar_file/evil_script.php</nowiki>") is allowed at anytime.

Current **allow_url_include** behavior is wrong for 2 reasons.

  - It's "caller" responsibility to set this setting as intended. (Or "callee" must have API for overriding it to do the job)
  - It does not make "include/require" behave as INI setting name implies.

**allow_url_include** being INI_SYSTEM is false sense of security. It also violates simple API principle that 

  * "caller" must have responsibility to set correct setting for conditions.
or
  * "callee" must have API/parameter to set correct conditions for the API.

Current **allow_url_include** and related API does not satisfy none of them.

===== Proposal =====

  * Make **allow_url_include** actually disallow URL form includes.
  * Change **allow_url_include** ini type from INI_SYSTEM to INI_ALL.


===== Backward Incompatible Changes =====

Implicitly allowed stream wrappers need to set('allow_url_include','On') before, set('allow_url_include', 'Off') after.

===== Proposed PHP Version(s) =====

PHP 7.0

===== RFC Impact =====
==== To SAPIs ====

None

==== To Existing Extensions ====

Phar

==== To Opcache ====

None

==== New Constants ====

None 

==== php.ini Defaults ====

**allow_url_include** ini type became INI_ALL from INI_SYSTEM. Default "Off" remains.

===== Open Issues =====


===== Unaffected PHP Functionality =====

allow_url_fopen

===== Future Scope =====

**allow_url_fopen** has the same issue.

===== Proposed Voting Choices =====
Requires 50%+1 majority


===== Patches and Tests =====

TBD

===== Implementation =====
After the project is implemented, this section should contain 
  - the version(s) it was merged to
  - a link to the git commit(s)
  - a link to the PHP manual entry for the feature

===== References =====
Links to external references, discussions or RFCs

===== Rejected Features =====
Keep this updated with features that were discussed on the mail lists.