====== Request for Comments: Use default_charset As Default Character Encoding ======
  * Version: 0.1
  * Date: 2012-08-30
  * Author: Yasuo Ohgaki <yohgaki@ohgaki.net>
  * Status: Under Discussion
  * First Published at: http://wiki.php.net/rfc/default_encoding

===== Introduction =====

This RFC proposes that use default_charset as default character encoding.

Current PHP does not have default encoding setting. This makes adoption of PHP 5.4 difficult, since PHP 5.4's htmlentities/htmlspecialchars is now default to UTF-8. Some applications are required to set proper encoding for htmlentities/htmlspecialchars for proper character processing. If users mixed ISO-8859-1 and UTF-8 (AND many other multibyte character encodings), it could cause security problem.

There are many encoding setting in php.ini and functions that users simply ignore and leave it alone. However, it is required to handle character encoding properly for secure programs.

===== Proposal =====

Set default_charset="UTF-8" as php default for both compiled and php.ini-*.

Use default_charset as default for encoding related php.ini and functions.

For PHP 5.4
  * iconv.input_encoding
  * iconv.internal_encoding
  * iconv.output_encoding
  * mbstring.http_input
  * mbstring.internal_encoding
  * mbstring.http_output
  * mbstring.script_encoding
  * all functions that takes encoding option (e.g. htmlentities/mb_strlen/etc)

For PHP 5.4 and master, introduce new php.ini settting. Old iconv.*/mbstring.* php.ini parameters will be removed for master.
  * php.input_encoding
  * php.internal_encoding
  * php.output_encoding
  * php.script_encoding

==== Precedence of settings ====

  default_charset < php.* < mbstring.*/iconv.* < encoding specified as function param
                            ^^^^^^^^^^^^^^^^^^
                            These settings are removed for master


===== Patch =====

Not yet

===== Vote =====

Not yet

===== References =====

  * Internals discussion - http://www.serverphorums.com/read.php?7,552099,552110

===== Changelog =====

  * 2012-08-31 Initial version. (yohgaki)